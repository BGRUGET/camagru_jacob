(function() {
    var video = document.getElementById('video'),
        canvas = document.getElementById('canvas'),
        //data = canvas.toDataURL(),
        context = canvas.getContext('2d'),
        vendorUrl = window.URL || window.webkitURL;

    navigator.getMedia =    navigator.getUserMedia ||
        navigator.webkitGetUserMedia ||
        navigator.mozGetUserMedia ||
        navigator.msGetUserMedia;

    navigator.getMedia({
        video: true,
        audio: false
    }, function (stream) {
        video.srcObject = stream
        video.play();
    }, function (error) {
        rip
    });

    document.getElementById('capture').addEventListener('click', function() {
        context.drawImage(video, 0, 0, 380, 300);
        var data = canvas.toDataURL();
        var mainDiv = document.getElementById('main-div');
        var img = document.createElement('img');
        img.src = data;
        var aff = document.getElementById('super_photo');
        aff.value = data;
        //mainDiv.appendChild(img);
    });

})();


function insert_photo(){
    const form = new FormData()
    var canvas = document.getElementById('canvas')
    var data = canvas.toDataURL();
    var fdp = 0;
    if (data != "data:image/png;base64,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") {
        form.append("superre_filtre", data)
        fetch("/index.php?p=studio", { credentials: "include", method: "POST", body: form })
            .then(r => r.text())
            .then(console.log);
    }
    else
    {
        const form1 = new FormData()
        alert('rip');
        fdp = 1;
        form.append("aa", fdp)
        fetch("/index.php?p=studio", { credentials: "include", method: "POST", body: form1 })
            .then(r => r.text())
    }
}

